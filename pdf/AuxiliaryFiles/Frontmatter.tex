\frontmatter

%%%%%%%% PAGE FORMAT
\newgeometry{
  top=3cm,
  bottom=3cm,
  left=2.5cm,
  right=2.5cm,
  headheight=0pt,
  headsep=0pt,
  footskip=20pt,        % increased to avoid footer being too close
  marginparsep=0pt,
  marginparwidth=0pt
}

%%%%%%%% PAGESTYLE
\fancypagestyle{fancyfront}{
  \renewcommand{\headrulewidth}{0pt}
  \renewcommand{\footrulewidth}{0.1pt}

  \pagenumbering{Roman}    % Roman numerals for front matter

  % Header: empty
  \fancyhead{}

  % Footer: centered page number only
  \fancyfoot[C]{\small\thepage}
}

\pagestyle{fancyfront}

%%%%%%%% TABLE OF CONTENTS
\ifnum\IndexYes=1
  \contentsmargin{0cm}

  % TOC Part
  \titlecontents{part}[4pc]
    {\addvspace{8pt}}{}
    {\Large\bfseries}
    {\tiny\color{black!50}\;\;\dotfill\;\large\bfseries\color{black}\PageName\, \thecontentspage}

  % TOC Chapter
  \titlecontents{chapter}[4pc]
    {\addvspace{16pt}\Large\bfseries\thecontentslabel}{\hspace{.5cm}}{}
    {\tiny\color{black!50}\;\;\dotfill\;\large\bfseries\color{black}\PageName\, \thecontentspage}

  % TOC Section
  \titlecontents{section}[5pc]
    {\addvspace{2pt}\bfseries\thecontentslabel\normalfont}{\hspace{.5cm}}{}
    {\tiny\color{black!50}\;\;\dotfill\;\normalsize\color{black}\PageName\, \thecontentspage}

  % TOC Subsection
  \titlecontents{subsection}[6pc]
    {\addvspace{2pt}\bfseries\thecontentslabel\normalfont}{\hspace{.5cm}}{}
    {\tiny\color{black!50}\;\;\dotfill\;\normalsize\color{black}\PageName\, \thecontentspage}

  {
    % Avoid two-sided blank pages
    \let\cleardoublepage\clearpage
    \renewcommand\contentsname{}
    \begin{minipage}[r]{.95\textwidth}\raggedleft
      \vspace{2.5cm}
      \HUGE\bfseries\ContentsName
      \vspace{-1cm}
    \end{minipage}

    \tableofcontents
    \vspace{0.25cm}
  }
\fi

\restoregeometry

